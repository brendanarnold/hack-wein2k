      subroutine comprel(ig1,ig2,ncm)
      IMPLICIT REAL*8 (A-H,O-Z)
!
      dimension      ncm(-14:14,4)
      character*3    grp1,grp2
      logical        C2(3,3),  C3(2,2), C4(2,2), C6(2,2)
      logical        IC2(3,3),IC3(2,2),IC4(2,2),IC6(2,2)
      common /cflg/  C2, C3, C4, C6, IC2, IC3, IC4, IC6
!
!     ncm( IR(p-grp1), ndeg=1-4 ) = the IR(p-grp2) of point group Grp2
!
!     See Koster, et al for the number of the IRs and for the 
!     Compatibility tables, the page number is indicated in the list below.
!----------------------------------------------------------------------------------
!
      ncm=0
      ig12 = 1000000 + 1000*ig1 + ig2
      write(6,*)'In comprel: ', ig1, ig2, ig12
      if(ig2.eq.1) stop 'comprel: point group E not used here'
!
      select case (ig12)
!
!**...C2h -> Ci  --------------------------------------------------- C2,Cs, p 34
      case (1005002)
          ncm( (/ 1, 2, -1, -2, 3, 4, -3, -4 /), 1) = & 
               (/ 1, 1, -1, -1, 2, 2, -2, -2 /)
!**...C2h -> C2 
      case (1005003)
          ncm( -4:4, 1) =  (/ (abs(i), i= -4, 4) /)
!**...C2h -> Cs 
      case (1005004)
          ncm( (/ 1, 2, -1, -2, 3, 4, -3, -4 /), 1) = & 
               (/ 1, 2,  2,  1, 3, 4,  4,  3 /)
!
!**...D2 -> C2  ------------------------------------------------- D2, C2v, p 37
      case (1006003)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 2, 1, 2, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 1, 2, 2, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 2, 2, 1, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
        else
          goto 899
        endif
!**...C2v -> C2 
      case (1007003)
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 2, 1, 2, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
!**...C2v -> Cs 
      case (1007004)
        if(      IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 1, 2, 2, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5 /), 1) = &
               (/ 1, 2, 2, 1, 3 /)
          ncm( (/             5 /), 2) = &
               (/             4 /)
        else
          goto 899
        endif
!
!**...D2h -> Ci  ------------------------------------------------ D2h, p 39
      case (1008002)
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 1,  1,  1, -1, -1, -1, -1, 2, -2 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               2, -2 /)
!**...D2h -> C2  
      case (1008003)
       if(      C2(1,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  1,  2,  1,  2,  1,  2, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /)  
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 1,  2,  2,  1,  1,  2,  2, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /) 
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  2,  1,  1,  2,  2,  1, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /) 
        else
          goto 899
        endif   
!**...D2h -> Cs
      case (1008004)
        if(      IC2(1,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  1,  2,  2,  1,  2,  1, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /)  
        elseif(  IC2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 1,  2,  2,  2,  2,  1,  1, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /) 
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  2,  1,  2,  1,  1,  2, 3,  3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4,  4 /) 
        else
          goto 899
        endif 
!**...D2h -> C2h  
      case (1008005)
        if(      C2(1,1).and.IC2(1,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  1,  2, -1, -2, -1, -2, 3, -3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4, -4 /)  
        elseif(  C2(2,1).and.IC2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 1,  2,  2, -1, -1, -2, -2, 3, -3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4, -4 /)  
        elseif(  C2(3,1).and.IC2(3,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  2,  1, -1, -2, -2, -1, 3, -3 /)
          ncm( (/                               5, -5 /), 2) = & 
               (/                               4, -4 /)  
        else
          goto 899
        endif     
!**...D2h -> D2 
      case (1008006)
        if(      C2(1,1).and.C2(2,2) )  then
          ncm( -5:5, 1) =  (/ (abs(i), i= -5, 5) /)
        elseif(  C2(1,1).and.C2(2,3) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 4,  3,  2,  1,  4,  3,  2, 5,  5 /)
        elseif(  C2(1,2).and.C2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 3,  2,  4,  1,  3,  2,  4, 5,  5 /)
        elseif(  C2(1,2).and.C2(2,3) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 4,  2,  3,  1,  4,  2,  3, 5,  5 /)
        elseif(  C2(1,3).and.C2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 3,  4,  2,  1,  3,  4,  2, 5,  5 /)
        elseif(  C2(1,3).and.C2(2,2) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  4,  3,  1,  2,  4,  3, 5,  5 /)
        else
          goto 899
        endif

!**...D2h -> C2v  
      case (1008007)
        if(      C2(1,1).and.IC2(2,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  3,  4,  3,  4,  1,  2, 5,  5 /)
        elseif(  C2(1,1).and.IC2(2,2) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 4,  3,  2,  3,  2,  1,  4, 5,  5 /)
        elseif(  C2(2,1).and.IC2(1,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 3,  2,  4,  3,  1,  4,  2, 5,  5 /)
        elseif(  C2(2,1).and.IC2(1,2) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 3,  4,  2,  3,  1,  2,  4, 5,  5 /)
!PB new case for bcc W
        elseif(  C2(2,1).and.IC2(1,3) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 3,  4,  2,  3,  1,  2,  4, 5,  5 /)
!end
!PB: following two IC2 cases interchanged for bcc W
        elseif(  C2(3,1).and.IC2(1,2) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 4,  2,  3,  3,  2,  4,  1, 5,  5 /)
        elseif(  C2(3,1).and.IC2(1,1) )  then
          ncm( (/ 1, 2,  3,  4, -1, -2, -3, -4, 5, -5 /), 1) = & 
               (/ 1, 2,  4,  3,  3,  4,  2,  1, 5,  5 /)
        else
          goto 899
        endif
!
!**...C4 -> C2  -------------------------------------- C4, S4, p 41
      case (1009003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 2, 2, 3, 4, 3, 4 /)
!**...S4 -> C2 
      case (1010003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 2, 2, 3, 4, 3, 4 /)
!
!**...C4h -> Ci  ---------------------------------------- C4h, p 43
      case (1011002)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 1, 1, 1, -1, -1, -1, -1, 2, 2, 2, 2, -2, -2, -2, -2 /)
!**...C4h -> C2
      case (1011003)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 1, 2, 2,  1,  1,  2,  2, 3, 4, 3, 4,  3,  4,  3,  4 /)
!**...C4h -> Cs 
      case (1011004)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 1, 2, 2,  2,  2,  1,  1, 3, 4, 3, 4,  4,  3,  4,  3 /)
!**...C4h -> C2h 
      case (1011005)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 1, 2, 2, -1, -1, -2, -2, 3, 4, 3, 4, -3, -4, -3, -4 /)
!**...C4h -> C4 
      case (1011009)
        if(     C4(1,1) )  then
          ncm( -8:8, 1) =  (/ (abs(i), i= -8, 8) /)
        elseif( C4(2,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 2, 4, 3,  1,  2,  4,  3, 6, 5, 8, 7,  6,  5,  8,  7 /)
        else
          goto 899
        endif  
!**...C4h -> S4 
      case (1011010)
        if(     IC4(1,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 2, 3, 4,  2,  1,  4,  3, 5, 6, 7, 8,  7,  8,  5,  6 /)
        elseif( IC4(2,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, 8, -5, -6, -7, -8 /), 1) = &
               (/ 1, 2, 4, 3,  2,  1,  3,  4, 6, 5, 8, 7,  8,  7,  6,  5 /)
        else
          goto 899
        endif 
!
!**...D4 -> C2  -------------------------------- D4, C4v, D2d, p 47
      case (1012003)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 1, 1, 2, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 2, 1, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        else
          goto 899
        endif 
!**...D4 -> D2  
      case (1012006)
        if(      C2(1,1).and.C2(2,2).and.C2(2,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 1, 3, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  C2(1,1).and.C2(3,2).and.C2(3,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 3, 1, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  C2(1,2).and.C2(2,1).and.C2(2,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 3, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  C2(1,2).and.C2(3,1).and.C2(3,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 2, 1, 3, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  C2(1,3).and.C2(2,1).and.C2(2,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 4, 1, 4, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             3       /) 
        elseif(  C2(1,3).and.C2(3,1).and.C2(3,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 4, 4, 1, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             3       /) 
        else
          goto 899
        endif 
!**...D4 -> C4 
      case (1012009)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 2, 2, 3, 5, 7 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             4, 6, 8 /) 
!**...C4v -> C2 
      case (1013003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 1, 1, 2, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
!**...C4v -> Cs 
      case (1013004)
        if(      IC2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        elseif(  IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 1, 3, 3 /) 
!pb for k2v3o8 (delta-gamma)  (/ 1, 2, 2, 1, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
!pb
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 2, 1, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        else
          goto 899
        endif 
!**...C4v -> C2v 
      case (1013007)
        if(      IC2(1,1).and.IC2(1,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 1, 3, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  IC2(2,1).and.IC2(2,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 3, 1, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        else
          goto 899
        endif 
!**...C4v -> C4 
      case (1013009)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
             (/ 1, 1, 2, 2, 3, 5, 7 /) 
        ncm( (/             5, 6, 7 /), 2) = &
             (/             4, 6, 8 /)
!**...D2d -> C2 
      case (1014003)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 1, 1, 2, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
        else
          goto 899
        endif 
!**...D2d -> Cs
      case (1014004)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 2, 1, 1, 3, 3 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             2, 4, 4 /) 
!**...D2d -> D2 
      case (1014006)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 1, 3, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 1, 2, 3, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /)
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 4, 1, 4, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             3       /)
        else
          goto 899
        endif 
!**...D2d -> C2v 
      case (1014007)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 3, 1, 2, 5, 5 /) 
          ncm( (/             5       /), 2) = &
               (/             4       /) 
!**...D2d -> S4 
      case (1014010)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 2, 2, 3, 5, 7 /) 
          ncm( (/             5, 6, 7 /), 2) = &
               (/             4, 6, 8 /)
!**...D4h -> Ci  --------------------------------------- D4h, p 50
      case (1015002)
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 2, 2, -2, -2 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             1,                 -1, 2, 2, -2, -2 /)
!**...D4h -> C2
      case (1015003)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1, 2,  1,  1,  1,  1,  2, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  2, 4, 4,  4,  4 /)
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 2, 1, 2, 1,  1,  2,  1,  2,  1, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  2, 4, 4,  4,  4 /)
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 2, 2, 1, 1,  1,  2,  2,  1,  1, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  2, 4, 4,  4,  4 /)
        else
          goto 899
        endif 
!**...D4h -> Cs
      case (1015004)
        if(      IC2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1, 2,  2,  2,  2,  2,  1, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  1, 4, 4,  4,  4 /)
        elseif(  IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 2, 1, 2, 1,  2,  1,  2,  1,  1, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  2, 4, 4,  4,  4 /)
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
               (/ 1, 2, 2, 1, 1,  2,  1,  1,  2,  1, 3, 3,  3,  3 /)
          ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
               (/             2,                  2, 4, 4,  4,  4 /)
        else
          goto 899
        endif 
!.....D4h -> C2h 
      case (1015005)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 2, 1, 2, 1, -1, -2, -1, -2, -1, 3, 3, -3, -3 /)
        ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
             (/             2,                 -2, 4, 4, -4, -4 /) 
!.....D4h -> C2v 
      case (1015007)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 2, 1, 2, 3,  3,  4,  3,  4,  1, 5, 5,  5,  5 /)
        ncm( (/             5,                 -5               /), 2) = &
             (/             4,                  2               /)
!added by PB, For P-lattice, interchange 2-4 of C2v // 3-4(m) in D4h
        if(      IC2(2,2) )  then
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 4, 1, 4, 3,  3,  2,  3,  2,  1, 5, 5,  5,  5 /)
        ncm( (/             5,                 -5               /), 2) = &
             (/             2,                  4               /)
        elseif(  IC2(3,2) )  then
        ncm( (/ 1, 2, 4, 3, 5, -1, -2, -4, -3, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 4, 1, 4, 3,  3,  2,  3,  2,  1, 5, 5,  5,  5 /)
        ncm( (/             5,                 -5               /), 2) = &
             (/             2,                  4               /)
        endif 
!end added
!.....D4h -> D2h 
      case (1015008)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 3, 1, 3, 2, -1, -3, -1, -3, -2, 5, 5, -5, -5 /)
        ncm( (/             5,                 -5               /), 2) = &
             (/             4,                 -4               /)
!.....D4h -> C4h 
      case (1015011)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 1, 2, 2, 3, -1, -1, -2, -2, -3, 5, 7, -5, -7 /)
        ncm( (/             5,                 -5, 6, 7, -6, -7 /), 2) = &
             (/             4,                 -4, 6, 8, -6, -8 /)
!.....D4h -> D4 
      case (1015012)
        ncm( -7:7, 1) =  (/ (abs(i), i= -7, 7) /)
!.....D4h -> C4v 
      case (1015013)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 2, 3, 4, 5,  2,  1,  4,  3,  5, 6, 7,  6,  7 /)
!.....D4h -> D2d 
      case (1015014)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, -6, -7 /), 1) = &
             (/ 1, 2, 3, 4, 5,  3,  4,  1,  2,  5, 6, 7,  7,  6 /)
!
!**...C3i -> Ci  ---------------------------------------- C3i, p 54
      case (1017002)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 1, 1, -1, -1, -1, 2, 2, 2, -2, -2, -2 /)
!**...C3i -> C3 
      case (1017016)
        if(      C3(1,1) )  then
          ncm( -6:6, 1) =  (/ (abs(i), i= -6, 6) /)
        elseif(  C3(2,1) )  then
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 3, 2,  1,  3,  2, 5, 4, 6,  5,  4,  6 /)
        else
          goto 899
        endif
!**...D3 -> C2  ------------------------------------- D3, C3v, p 57
      case (1018003)
          ncm( (/ 1, 2, 3, 4, 5, 6 /), 1) = &
               (/ 1, 2, 1, 3, 3, 4 /)
          ncm( (/       3, 4       /), 2) = &
               (/       2, 4       /)
!**...D3 -> C3 
      case (1018016)
          ncm( (/ 1, 2, 3, 4, 5, 6 /), 1) = &
               (/ 1, 1, 2, 4, 6, 6 /)
          ncm( (/       3, 4       /), 2) = &
               (/       3, 5       /)
!**...C3v -> Cs 
      case (1019004)
          ncm( (/ 1, 2, 3, 4, 5, 6 /), 1) = &
               (/ 1, 2, 1, 3, 3, 4 /)
          ncm( (/       3, 4       /), 2) = &
               (/       2, 4       /)
!**...C3v -> C3 
      case (1019016)
          ncm( (/ 1, 2, 3, 4, 5, 6 /), 1) = &
               (/ 1, 1, 2, 4, 6, 6 /)
          ncm( (/       3, 4       /), 2) = &
               (/       3, 5       /)
!
!**...D3d -> Ci  --------------------------------------- D3d, p 58
      case (1020002)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 1, 1, -1, -1, -1, 2, 2, 2, -2, -2, -2 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       1,         -1, 2,       -2         /)
!**...D3d -> C2  
      case (1020003)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 2, 1,  1,  2,  1, 3, 3, 4,  3,  3,  4 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       2,          2, 4,        4         /)
!**...D3d -> Cs  
      case (1020004)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 2, 1,  2,  1,  1, 3, 3, 4,  3,  4,  3 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       2,          2, 4,        4         /)
!**...D3d -> C2h 
      case (1020005)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 2, 1, -1, -2, -1, 3, 3, 4, -3, -3, -4 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       2,         -2, 4,       -4         /)
!**...D3d -> C3 
      case (1020016)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 1, 2,  1,  1,  2, 4, 6, 6,  4,  6,  6 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       3,          3, 5,        5         /)
!**...D3d -> C3i 
      case (1020017)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 1, 2, -1, -1, -2, 4, 6, 6, -4, -6, -6 /)
          ncm( (/       3,         -3, 4,       -4         /), 2) = &
               (/       3,         -3, 5,       -5         /)
!**...D3d -> D3 
      case (1020018)
          ncm( -6:6, 1) =  (/ (abs(i), i= -6, 6) /)
!**...D3d -> C3v 
      case (1020019)
          ncm( (/ 1, 2, 3, -1, -2, -3, 4, 5, 6, -4, -5, -6 /), 1) = &
               (/ 1, 2, 3,  2,  1,  3, 4, 5, 6,  5,  4,  6 /)
!
!**...C6 -> C2  ------------------------------------- C6, C3h, p 61
      case (1021003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
               (/ 1, 1, 1, 2, 2, 2, 3, 4, 4,  3,  3,  4 /)
!**...C6 -> C3 
      case (1021016)
        if(      C3(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
               (/ 1, 2, 3, 1, 2, 3, 4, 5, 4,  5,  6,  6 /)
        elseif(  C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
               (/ 1, 3, 2, 1, 3, 2, 5, 4, 5,  4,  6,  6 /)
        else
          goto 899
        endif
!**...C3h -> Cs
      case (1022004)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
              (/ 1, 1, 1, 2, 2, 2, 3, 4, 4,  3,  3,  4 /)
!**...C3h -> C3 
      case (1022016)
        if(      C3(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
               (/ 1, 2, 3, 1, 2, 3, 4, 5, 4,  5,  6,  6 /)
        elseif(  C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12 /), 1) = &
               (/ 1, 3, 2, 1, 3, 2, 5, 4, 5,  4,  6,  6 /)
        else
          goto 899
        endif
!
!**...C6h -> Ci -------------------------------------------- C6h, p 64
      case (1023002)
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
               (/ 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 2, 2, 2,  2,  2,  2, -2, -2, -2,  -2,  -2,  -2 /) 
!**...C6h -> C2 
      case (1023003)
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
               (/ 1, 1, 1, 2, 2, 2,  1,  1,  1,  2,  2,  2, 3, 4, 4,  3,  3,  4,  3,  4,  4,   3,   3,   4 /) 
!**...C6h -> Cs 
      case (1023004)
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
               (/ 1, 1, 1, 2, 2, 2,  2,  2,  2,  1,  1,  1, 3, 4, 4,  3,  3,  4,  4,  3,  3,   4,   4,   3 /) 
!.....C6h -> C2h 
      case (1023005)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
             (/ 1, 1, 1, 2, 2, 2, -1, -1, -1, -2, -2, -2, 3, 4, 4,  3,  3,  4, -3, -4, -4,  -3,  -3,  -4 /) 
!.....C6h -> C3i 
      case (1023017)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
             (/ 1, 2, 3, 1, 2, 3, -1, -2, -3, -1, -2, -3, 4, 5, 4,  5,  6,  6, -4, -5, -4,  -5,  -6,  -6 /) 
!.....C6h -> C6 
      case (1023021)
          ncm( -12:12, 1) =  (/ (abs(i), i= -12, 12) /)
!.....C6h -> C3h 
      case (1023022)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, 10, 11, 12, -7, -8, -9, -10, -11, -12 /), 1) = &
             (/ 1, 2, 3, 4, 5, 6,  4,  5,  6,  1,  2,  3, 7, 8, 9, 10, 11, 12,  9, 10,  7,   8,  12,  11 /)
!
!**...D6 -> C2  -------------------------------- D6, C6v, D3h, p 72
      case (1024003)
        if(      C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 1, 2, 2, 2, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 1, 4, 4, 4 /)
        elseif(  C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 2, 1, 2, 1, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 2, 4, 4, 4 /)
        elseif(  C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 2, 2, 1, 1, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 2, 4, 4, 4 /)
        else
          goto 899
        endif
!.....D6 -> D2 
      case (1024006)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 3, 2, 4, 2, 1, 5, 5, 5 /)
        ncm( (/             5, 6          /), 2) = &
             (/             4, 3          /)
!.....D6 -> D3 
      case (1024018)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 1, 2, 3, 3, 4, 4, 5 /)
        ncm( (/                         9 /), 2) = &
             (/                         6 /)
!.....D6 -> C6 
      case (1024021)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7,  8,  9 /), 1) = &
             (/ 1, 1, 4, 4, 5, 2, 7,  9, 11 /)
        ncm( (/             5, 6, 7,  8,  9 /), 2) = &
             (/             6, 3, 8, 10, 12 /)
!**...C6v -> C2 
      case (1025003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 1, 2, 2, 2, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 1, 4, 4, 4 /)
!**...C6v -> Cs 
      case (1025004)
        if(      IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 2, 1, 2, 1, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 2, 4, 4, 4 /)
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 2, 2, 1, 1, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 2, 4, 4, 4 /)
        else
          goto 899
        endif
!.....C6v -> C2v 
      case (1025007)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 3, 2, 4, 2, 1, 5, 5, 5 /)
        ncm( (/             5, 6          /), 2) = &
             (/             4, 3          /)

!.....C6v -> C3v 
      case (1025019)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 1, 2, 3, 3, 4, 4, 5 /)
        ncm( (/                         9 /), 2) = &
             (/                         6 /)
!.....C6v -> C6 
      case (1025021)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7,  8,  9 /), 1) = &
             (/ 1, 1, 4, 4, 5, 2, 7,  9, 11 /)
        ncm( (/             5, 6, 7,  8,  9 /), 2) = &
             (/             6, 3, 8, 10, 12 /)
!**...D3h -> C2 
      case (1026003)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 1, 2, 1, 1, 3, 3, 3 /)
        ncm( (/             5, 6, 7, 8, 9 /), 2) = &
             (/             2, 2, 4, 4, 4 /)
!**...D3h -> Cs 
      case (1026004)
        if(      IC2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 1, 2, 2, 2, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 1, 4, 4, 4 /)
        elseif(  IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
               (/ 1, 2, 2, 1, 1, 1, 3, 3, 3 /)
          ncm( (/             5, 6, 7, 8, 9 /), 2) = &
               (/             2, 2, 4, 4, 4 /)
        else
          goto 899
        endif
!
!.....D3h -> C2v 
      case (1026007)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 3, 4, 3, 1, 5, 5, 5 /)
        ncm( (/             5, 6          /), 2) = &
             (/             4, 2          /)
!.....D3h -> D3 
      case (1026018)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 1, 2, 3, 3, 4, 4, 5 /)
        ncm( (/                         9 /), 2) = &
             (/                         6 /)
!.....D3h -> C3v 
      case (1026019)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8, 9 /), 1) = &
             (/ 1, 2, 2, 1, 3, 3, 4, 4, 5 /)
        ncm( (/                         9 /), 2) = &
             (/                         6 /)
!.....D3h -> C3h 
      case (1026022)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7,  8,  9 /), 1) = &
             (/ 1, 1, 4, 4, 5, 2, 7,  9, 11 /)
        ncm( (/             5, 6, 7,  8,  9 /), 2) = &
             (/             6, 3, 8, 10, 12 /)
!
!**...D6h -> Ci  --------------------------------------- D6h, p 78
      case (1027002)
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 2, 2, 2, -2, -2, -2 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             1, 1,                 -1, -1, 2, 2, 2, -2, -2, -2 /)
!**...D6h -> C2  
      case (1027003)
        if(       C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 1, 2, 2, 2, 1,  1,  1,  2,  2,  2,  1, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 1,                  2,  1, 4, 4, 4,  4,  4,  4 /)
        elseif(   C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 2, 1, 2, 1, 1,  1,  2,  1,  2,  1,  1, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 2,                  2,  2, 4, 4, 4,  4,  4,  4 /)
        elseif(   C2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 2, 2, 1, 1, 1,  1,  2,  2,  1,  1,  1, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 2,                  2,  2, 4, 4, 4,  4,  4,  4 /)
        else
          goto 899
        endif
!**...D6h -> Cs
      case (1027004)
        if(       IC2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 1, 2, 2, 2, 1,  2,  2,  1,  1,  1,  2, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 1,                  1,  2, 4, 4, 4,  4,  4,  4 /)
        elseif(   IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 2, 1, 2, 1, 1,  2,  1,  2,  1,  1,  1, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 2,                  2,  2, 4, 4, 4,  4,  4,  4 /)
        elseif(   IC2(3,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
               (/ 1, 2, 2, 1, 1, 1,  2,  1,  1,  2,  1,  1, 3, 3, 3,  3,  3,  3 /)
          ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
               (/             2, 2,                  2,  2, 4, 4, 4,  4,  4,  4 /)
        else
          goto 899
        endif
!.....D6h -> C2h  
      case (1027005)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 2, 1, 2, 1, 1, -1, -2, -1, -2, -1, -1, 3, 3, 3, -3, -3, -3 /)
        ncm( (/             5, 6,                 -5, -6, 7, 8, 9, -7, -8, -9 /), 2) = &
             (/             2, 2,                 -2, -2, 4, 4, 4, -4, -4, -4 /)
!.....D6h -> C2v 
      case (1027007)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 2, 3, 4, 3, 1,  3,  4,  1,  2,  1,  3, 5, 5, 5,  5,  5,  5 /)
        ncm( (/             5, 6,                 -5, -6                      /), 2) = &
             (/             4, 2,                  2,  4                      /)
!.....D6h -> D2h
      case (1027008)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 3, 2, 4, 2, 1, -1, -3, -2, -4, -2, -1, 5, 5, 5, -5, -5, -5 /)
        ncm( (/             5, 6,                 -5, -6                      /), 2) = &
             (/             4, 3,                 -4, -3                      /)
!.....D6h -> D3d 
      case (1027020)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 2, 1, 2, 3, 3, -1, -2, -1, -2, -3, -3, 4, 4, 5, -4, -4, -5 /)
        ncm( (/                                                 9,         -9 /), 2) = &
             (/                                                 6,         -6 /)
!.....D6h -> C6h 
      case (1027023)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7,  8,  9,  -7,  -8,  -9 /), 1) = &
             (/ 1, 1, 4, 4, 5, 2, -1, -1, -4, -4, -5, -2, 7,  9, 11,  -7,  -9, -11 /)
        ncm( (/             5, 6,                 -5, -6, 7,  8,  9,  -7,  -8,  -9 /), 2) = &
             (/             6, 3,                 -6, -3, 8, 10, 12,  -8, -10, -12 /)
!.....D6h -> D6 
      case (1027024)
        ncm( -9:9, 1) =  (/ (abs(i), i= -9, 9) /)
!.....D6h -> C6v 
      case (1027025)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 2, 3, 4, 5, 6,  2,  1,  4,  3,  5,  6, 7, 8, 9,  7,  8,  9 /)
!.....D6h -> D3h 
      case (1027026)
        ncm( (/ 1, 2, 3, 4, 5, 6, -1, -2, -3, -4, -5, -6, 7, 8, 9, -7, -8, -9 /), 1) = &
             (/ 1, 2, 4, 3, 5, 6,  3,  4,  2,  1,  6,  5, 7, 8, 9,  8,  7,  9 /)
!
!**...T -> C2  ------------------------------------------------------------------ T, p 85
      case (1028003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 1, 1, 3, 3, 3 /) 
          ncm( (/          4, 5, 6, 7 /), 2) = &
               (/          2, 4, 4, 4 /) 
          ncm( (/          4          /), 3) = &
               (/          2          /) 
!**...T -> D2 
      case (1028006)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 1, 1, 2, 5, 5, 5 /) 
          ncm( (/          4          /), 2) = &
               (/          3          /) 
          ncm( (/          4          /), 3) = &
               (/          4          /) 
!**...T -> C3 
      case (1028016)
        if(       C3(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 2, 3, 1, 4, 4, 5 /) 
          ncm( (/          4, 5, 6, 7 /), 2) = &
               (/          2, 5, 6, 6 /) 
          ncm( (/          4          /), 3) = &
               (/          3          /)
        elseif(   C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7 /), 1) = &
               (/ 1, 3, 2, 1, 4, 5, 4 /) 
          ncm( (/          4, 5, 6, 7 /), 2) = &
               (/          2, 5, 6, 6 /) 
          ncm( (/          4          /), 3) = &
               (/          3          /)
        else
          goto 899
        endif
!
!**...Th -> Ci  ------------------------------------------ Th, p 87
      case (1029002)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1, -1, -1, -1, -1, 2, 2, 2, -2, -2, -2 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          1,             -1, 2, 2, 2, -2, -2, -2 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          1,             -1                      /)
!**...Th -> C2 
      case (1029003)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1,  1,  1,  1,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,              2, 4, 4, 4,  4,  4,  4 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          2,              2                      /)
!**...Th -> Cs 
      case (1029004)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1,  2,  2,  2,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,              1, 4, 4, 4,  4,  4,  4 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          2,              2                      /)
!**...Th -> C2h 
      case (1029005)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 1, -1, -1, -1, -1, 3, 3, 3, -3, -3, -3 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,             -2, 4, 4, 4, -4, -4, -4 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          2,             -2                      /)
!**...Th -> D2 
      case (1029006)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 2,  1,  1,  1,  2, 5, 5, 5,  5,  5,  5 /) 
          ncm( (/          4,             -4                      /), 2) = &
               (/          3,              3                      /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          4,              4                      /)
!**...Th -> C2v 
      case (1029007)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 2,  3,  3,  3,  1, 5, 5, 5,  5,  5,  5 /) 
          ncm( (/          4,             -4                      /), 2) = &
               (/          3,              2                      /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          4,              4                      /)
!**...Th -> D2h 
      case (1029008)
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 1, 1, 2, -1, -1, -1, -2, 5, 5, 5, -5, -5, -5 /) 
          ncm( (/          4,             -4                      /), 2) = &
               (/          3,             -3                      /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          4,             -4                      /)
!**...Th -> C3 
      case (1029016)
        if(       C3(1,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 2, 3, 1,  1,  2,  3,  1, 4, 4, 5,  4,  4,  5 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,              2, 5, 6, 6,  5,  6,  6 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          3,              3                      /)
        elseif(   C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 3, 2, 1,  1,  3,  2,  1, 4, 5, 4,  4,  5,  4 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,              2, 5, 6, 6,  5,  6,  6 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          3,              3                      /)
        else
          goto 899
        endif
!**...Th -> C3i 
      case (1029017)
        if(       C3(1,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 2, 3, 1, -1, -2, -3, -1, 4, 4, 5, -4, -4, -5 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,             -2, 5, 6, 6, -5, -6, -6 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          3,             -3                      /)
        elseif(   C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 2, 3, 1, -1, -3, -2, -1, 4, 5, 4, -4, -5, -4 /) 
          ncm( (/          4,             -4, 5, 6, 7, -5, -6, -7 /), 2) = &
               (/          2,             -2, 5, 6, 6, -5, -6, -6 /) 
          ncm( (/          4,             -4                      /), 3) = &
               (/          3,             -3                      /)
        else
          goto 899
        endif
!**...Th -> T 
      case (1029028)
        if(       C3(1,1) )  then
          ncm( -7:7, 1) =  (/ (abs(i), i= -7, 7) /)
        elseif(   C3(2,1) )  then
          ncm( (/ 1, 2, 3, 4, -1, -2, -3, -4, 5, 6, 7, -5, -6, -7 /), 1) = &
               (/ 1, 3, 2, 4,  1,  3,  2,  4, 5, 7, 6,  5,  7,  6 /)
        else
          goto 899
        endif
!
!**...O -> C2 --------------------------------------- O, Td p 100
      case (1030003)
        if(       C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 1, 1, 1, 3, 3, 3 /) 
          ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
               (/       1, 2, 2, 4, 4, 3 /) 
          ncm( (/          4, 5,       8 /), 3) = &
               (/          2, 2,       4 /) 
          ncm( (/                      8 /), 4) = &
               (/                      4 /)
        elseif(   C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 2, 1, 1, 1, 3, 3, 3 /) 
          ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
               (/       2, 2, 1, 4, 4, 3 /) 
          ncm( (/          4, 5,       8 /), 3) = &
               (/          2, 2,       4 /) 
          ncm( (/                      8 /), 4) = &
               (/                      4 /) 
        else
          goto 899
        endif

!**...O -> D2 
      case (1030006)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 1, 2, 2, 5, 5, 5 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       1, 3, 3,       5 /) 
          ncm( (/          4, 5          /), 3) = &
               (/          4, 4          /) 
!.....O -> C4 
      case (1030009)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
             (/ 1, 2, 1, 1, 2, 5, 7, 5 /) 
        ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
             (/       2, 3, 3, 6, 8, 6 /) 
        ncm( (/          4, 5,       8 /), 3) = &
             (/          4, 4,       7 /) 
        ncm( (/                      8 /), 4) = &
             (/                      8 /) 
!**...O -> D4 
      case (1030012)
        if(       C2(1,1).and.C2(1,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 3, 1, 2, 4, 6, 7, 6 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       3, 5, 5,       7 /)
        elseif(   C2(1,1).and.C2(1,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 4, 1, 2, 3, 6, 7, 6 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       4, 5, 5,       7 /) 
        else
          goto 899
        endif
!**...O -> C3 
      case (1030016)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
             (/ 1, 1, 2, 1, 1, 4, 4, 4 /) 
        ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
             (/       3, 2, 2, 5, 5, 5 /) 
        ncm( (/          4, 5,       8 /), 3) = &
             (/          3, 3,       6 /) 
        ncm( (/                      8 /), 4) = &
             (/                      6 /) 
!**...O -> D3 
      case (1030018)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 2, 3, 2, 1, 4, 4, 4 /) 
          ncm( (/          4, 5,       8 /), 2) = &
               (/          3, 3,       5 /) 
          ncm( (/                      8 /), 3) = &
               (/                      6 /) 
!**...O -> T 
      case (1030028)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 2, 4, 4, 5, 5, 6 /) 
          ncm( (/       3,             8 /), 2) = &
               (/       3,             7 /) 
!**...Td -> C2 
      case (1031003)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 1, 1, 1, 3, 3, 3 /) 
          ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
               (/       1, 2, 2, 4, 4, 3 /) 
          ncm( (/          4, 5,       8 /), 3) = &
               (/          2, 2,       4 /) 
          ncm( (/                      8 /), 4) = &
               (/                      4 /) 
!**...Td -> Cs 
      case (1031004)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 2, 1, 1, 1, 3, 3, 3 /) 
          ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
               (/       2, 2, 1, 4, 4, 3 /) 
          ncm( (/          4, 5,       8 /), 3) = &
               (/          2, 2,       4 /) 
          ncm( (/                      8 /), 4) = &
               (/                      4 /) 
!**...Td -> C2v 
      case (1031007)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 3, 1, 2, 1, 5, 5, 5 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       3, 3, 2,       5 /) 
          ncm( (/          4, 5          /), 3) = &
               (/          4, 4          /) 
!.....Td -> S4 
      case (1031010)
        ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
             (/ 1, 2, 1, 1, 2, 5, 7, 5 /) 
        ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
             (/       2, 3, 3, 6, 8, 6 /) 
        ncm( (/          4, 5,       8 /), 3) = &
             (/          4, 4,       7 /) 
        ncm( (/                      8 /), 4) = &
             (/                      8 /) 
!**...Td -> D2d 
      case (1031014)
        if(       C2(1,1).and.C2(1,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 3, 1, 2, 4, 6, 7, 6 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       3, 5, 5,       7 /)
        elseif(   C2(1,1).and.C2(1,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 4, 1, 2, 3, 6, 7, 6 /) 
          ncm( (/       3, 4, 5,       8 /), 2) = &
               (/       4, 5, 5,       7 /) 
        else
          goto 899
        endif
!
!**...Td -> C3 
      case (1031016)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 2, 1, 1, 4, 4, 4 /) 
          ncm( (/       3, 4, 5, 6, 7, 8 /), 2) = &
               (/       3, 2, 2, 5, 5, 5 /) 
          ncm( (/          4, 5,       8 /), 3) = &
               (/          3, 3,       6 /) 
          ncm( (/                      8 /), 4) = &
               (/                      6 /) 
!**...Td -> C3v 
      case (1031019)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 2, 3, 2, 1, 4, 4, 4 /) 
          ncm( (/          4, 5,       8 /), 2) = &
               (/          3, 3,       5 /) 
          ncm( (/                      8 /), 3) = &
               (/                      6 /) 
!**...Td -> T 
      case (1031028)
          ncm( (/ 1, 2, 3, 4, 5, 6, 7, 8 /), 1) = &
               (/ 1, 1, 2, 4, 4, 5, 5, 6 /) 
          ncm( (/       3,             8 /), 2) = &
               (/       3,             7 /) 
!
!**...Oh -> Ci  --------------------------------------- Oh, p 104
      case (1032002)
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, 2, 2, 2, -2, -2, -2 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
               (/       1, 1, 1,         -1, -1, -1, 2, 2, 2, -2, -2, -2 /) 
          ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
               (/          1, 1,             -1, -1,       2,         -2 /) 
          ncm( (/                                          8,         -8 /), 4) = &
               (/                                          2,         -2 /) 
!**...Oh -> C2
      case (1032003)
        if(       C2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 1, 1, 1, 1,  1,  1,  1,  1,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
               (/       1, 2, 2,          1,  2,  2, 4, 4, 3,  4,  4,  3 /) 
          ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
               (/          2, 2,              2,  2,       4,          4 /) 
          ncm( (/                                          8,         -8 /), 4) = &
               (/                                          4,          4 /) 
        elseif(   C2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 2, 1, 1, 1,  1,  2,  1,  1,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
               (/       2, 2, 1,          2,  2,  1, 4, 4, 3,  4,  4,  3 /) 
          ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
               (/          2, 2,              2,  2,       4,          4 /) 
          ncm( (/                                          8,         -8 /), 4) = &
               (/                                          4,          4 /) 
        else
          goto 899
        endif
!**...Oh -> Cs
      case (1032004)
        if(       IC2(1,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 1, 1, 1, 1,  2,  2,  2,  1,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
               (/       1, 2, 2,          2,  1,  1, 4, 4, 3,  4,  4,  3 /) 
          ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
               (/          2, 2,              2,  2,       4,          4 /) 
          ncm( (/                                          8,         -8 /), 4) = &
               (/                                          4,          4 /) 
        elseif(   IC2(2,1) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 2, 1, 1, 1,  2,  1,  1,  1,  1, 3, 3, 3,  3,  3,  3 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
               (/       2, 2, 1,          2,  1,  2, 4, 4, 3,  4,  4,  3 /) 
          ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
               (/          2, 2,              2,  2,       4,          4 /) 
          ncm( (/                                          8,         -8 /), 4) = &
               (/                                          4,          4 /) 
        else
          goto 899
        endif
!.....Oh -> C2h  --------------------------------------- Oh, p 104
      case (1032005)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 1, 1, 1, -1, -2, -1, -1, -1, 3, 3, 3, -3, -3, -3 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
             (/       2, 2, 1,         -2, -2, -1, 4, 4, 3, -4, -4, -3 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
             (/          2, 2,             -2, -2,       4,         -4 /) 
        ncm( (/                                          8,         -8 /), 4) = &
             (/                                          4,         -4 /) 
!.....Oh -> C2v 
      case (1032007)
        if(       C2(2,1).and.IC2(1,2) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 2, 1, 2, 1,  3,  4,  3,  1,  1, 5, 5, 5,  5,  5,  5 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5,       8,         -8 /), 2) = &
               (/       2, 3, 3,          4,  2,  2,       5,          5 /) 
          ncm( (/          4, 5,             -4, -5                      /), 3) = &
               (/          4, 4,              4,  3                      /)
        elseif(   C2(2,1).and.IC2(1,3) )  then
          ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
               (/ 1, 4, 1, 2, 1,  3,  2,  2,  1,  1, 5, 5, 5,  5,  5,  5 /) 
          ncm( (/       3, 4, 5,         -3, -4, -5,       8,         -8 /), 2) = &
               (/       4, 3, 2,          3,  2,  3,       5,          5 /) 
          ncm( (/          4, 5,             -4, -5                      /), 3) = &
               (/          4, 3,              4,  4                      /)
        else
          goto 899
        endif
!**...Oh -> C4 
      case (1032009)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 1, 1, 2,  1,  2,  1,  1,  2, 5, 7, 5,  5,  7,  5 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
             (/       2, 3, 3,          2,  3,  3, 6, 8, 6,  6,  8,  6 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
             (/          4, 4,              4,  4,       7,          7 /)
        ncm( (/                                          8,         -8 /), 4) = &
             (/                                          8,          8 /)
!**...Oh -> C4h 
      case (1032011)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 1, 1, 2, -1, -2, -1, -1, -2, 5, 7, 5, -5, -7, -5 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
             (/       2, 3, 3,         -2, -3, -3, 6, 8, 6, -6, -8, -6 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
             (/          4, 4,             -4, -4,       7,         -7 /)
        ncm( (/                                          8,         -8 /), 4) = &
             (/                                          8,         -8 /)
!.....Oh -> C4v 
      case (1032013)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 3, 1, 2, 4,  2,  4,  2,  1,  3, 6, 7, 6,  6,  7,  6 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5,       8,         -8 /), 2) = &
             (/       3, 5, 5,          4,  5,  5,       7,          7 /)
!.....Oh -> D4h 
      case (1032015)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 3, 1, 2, 4, -1, -3, -1, -2, -4, 6, 7, 6, -6, -7, -6 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5,       8,         -8 /), 2) = &
             (/       3, 5, 5,         -3, -5, -5,       7,         -7 /)
!**...Oh -> C3i 
      case (1032017)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 1, 2, 1, 1, -1, -1, -2, -1, -1, 4, 4, 4, -4, -4, -4 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
             (/       3, 2, 2,         -3, -2, -2, 5, 5, 5, -5, -5, -5 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
             (/          3, 3,             -3, -3,       6,         -6 /)
        ncm( (/                                          8,         -8 /), 4) = &
             (/                                          6,         -6 /)
!**...Oh -> C3 
      case (1032016)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 1, 2, 1, 1,  1,  1,  2,  1,  1, 4, 4, 4,  4,  4,  4 /) 
        ncm( (/       3, 4, 5,         -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 2) = &
             (/       3, 2, 2,          3,  2,  2, 5, 5, 5,  5,  5,  5 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 3) = &
             (/          3, 3,              3,  3,       6,          6 /)
        ncm( (/                                          8,         -8 /), 4) = &
             (/                                          6,          6 /)
!.....Oh -> C3v 
      case (1032019)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 3, 2, 1,  2,  1,  3,  1,  2, 4, 4, 4,  4,  4,  4 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 2) = &
             (/          3, 3,              3,  3,       5,          5 /)
        ncm( (/                                          8,         -8 /), 3) = &
             (/                                          6,          6 /)
!.....Oh -> D3d 
      case (1032020)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 3, 2, 1, -1, -2, -3, -2, -1, 4, 4, 4, -4, -4, -4 /) 
        ncm( (/          4, 5,             -4, -5,       8,         -8 /), 2) = &
             (/          3, 3,             -3, -3,       5,         -5 /)
        ncm( (/                                          8,         -8 /), 3) = &
             (/                                          6,         -6 /)
!**...Oh -> T 
      case (1032028)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 1, 2, 4, 4,  1,  1,  2,  4,  4, 5, 5, 6,  5,  5,  6 /) 
        ncm( (/       3,               -3,               8,         -8 /), 2) = &
             (/       3,                3,               7,          7 /)
!**...Oh -> Th 
      case (1032029)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 1, 2, 4, 4, -1, -1, -2, -4, -4, 5, 5, 6, -5, -5, -6 /) 
        ncm( (/       3,               -3,               8,         -8 /), 2) = &
             (/       3,               -3,               7,         -7 /)
!**...Oh -> O 
      case (1032030)
        ncm( -8:8, 1) =  (/ (abs(i), i= -8, 8) /)
!**...Oh -> Td 
      case (1032031)
        ncm( (/ 1, 2, 3, 4, 5, -1, -2, -3, -4, -5, 6, 7, 8, -6, -7, -8 /), 1) = &
             (/ 1, 2, 3, 4, 5,  2,  1,  3,  5,  4, 6, 7, 8,  7,  6,  8 /)
!
     end select
     goto 900
!
 899  continue
      write(6,*) 'ERROR in comprel: cannot find com.rel for ',ig1,' to ', ig2
      stop 'ERROR in comprel: cannot find com.rel'
      
 900  return
      end


