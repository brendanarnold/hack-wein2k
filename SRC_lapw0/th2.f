      SUBROUTINE TH2(ROA,ROAX,ROAY,ROAZ,GROA,GDGGU,XLAPA, &
      ROB,ROBX,ROBY,ROBZ,GROB,GDGGD,XLAPB,GRO,GDGGT,EXC,VXCA,VXCB)
      IMPLICIT REAL*8 (A-H,O-Z)
      PARAMETER(CON43=4.D0/3.D0,CON83=8.D0/3.D0,CON13=1.D0/3.D0)
      PARAMETER(CON76=7.D0/6.D0,CON86=8.D0/6.D0,CON96=9.D0/6.D0, &
                CON106=10.D0/6.D0,CON116=11.D0/6.D0,CON126=2.D0, &
                CON1312=13.D0/12.D0,CON1712=17.D0/12D0)
      DIMENSION R(7:14),DRDA(7:14),DRDB(7:14),CONR(7:14)
      DIMENSION X(2),DXDA(2),DXDB(2)
      REAL CONST(19)
      INTEGER ICONR(19),ipri
      DATA CONST/0.678831D0,-0.175821D1,0.127676D1,-0.160789D1, &
                 0.365610D0,-0.181327D0,0.146973D0, 0.147141D0, &
                -0.716917D-1,-0.407167D-1,0.214625D-1,-0.768156D-3, &
                 0.310377D-1,-0.720326D-1,0.446562D-1,-0.266802D0, &
                 0.150822D1,-0.194515D1,0.679078D0/
      DATA CONR/CON76,CON86,CON96,CON106,CON116,CON126,CON1312,CON1712/
      DATA ICONR/13,7,8,9,10,14,9,10,11,10,11,12,10,11,12,7,8,9,10/
      DATA IPRI/0/
      SAVE IPRI
      IF(GROA.LT.1.D-8.OR.GROB.LT.1.D-8)THEN
        WRITE(*,*) IPRI,'SET TO 1'
        IPRI=IPRI+1
      ENDIF
      EXC=0.D0
      VXCA=0.D0
      VXCB=0.D0
      RO=ROA+ROB
      ROX=ROAX+ROBX
      ROY=ROAY+ROBY
      ROZ=ROAZ+ROBZ
      GRO2A=GROA**2
      GRO2B=GROB**2
      GFGFU=ROX*ROAX+ROY*ROAY+ROZ*ROAZ
      GFGFD=ROX*ROBX+ROY*ROBY+ROZ*ROBZ
      GFUGFD=ROAX*ROBX+ROAY*ROBY+ROAZ*ROBZ
      F43MU=2.D0*RO**CON43*GROA
      F43MD=2.D0*RO**CON43*GROB
!     R PRIME
      DO I=7,14
       R(I)=ROA**CONR(I)+ROB**CONR(I)
       DRDA(I)=CONR(I)*ROA**(CONR(I)-1.D0)
       DRDB(I)=CONR(I)*ROB**(CONR(I)-1.D0)
      ENDDO
!     S PRIME
      S=((ROA-ROB)/RO)**2
      DSDA=4.D0*(ROA-ROB)*ROB/RO**3
      DSDB=-4.D0*(ROA-ROB)*ROA/RO**3
!     X PRIME
      X(1)=(GROA+GROB)/(2.D0*RO**CON43)
      DXDA(1)=-CON43*X(1)/RO
      DXDB(1)=DXDA(1)
      X(2)=(GRO2A+GRO2B)/(2.D0*RO**CON83)
      DXDA(2)=-CON83*X(2)/RO
      DXDB(2)=DXDA(2)
!     Y PRIME
      Y=(GRO2A+GRO2B-2.D0*GFUGFD)/RO**CON83
      DYDA=-CON83*Y/RO
      DYDB=-CON83*Y/RO
      DO I=1,5
       JR=ICONR(I)
       EXC=EXC+CONST(I)*R(JR)
       VXCA=VXCA+CONST(I)*DRDA(JR)
       VXCB=VXCB+CONST(I)*DRDB(JR)
      ENDDO
      DO I=6,9
       JR=ICONR(I)
       JX=1
       EXC=EXC+CONST(I)*R(JR)*X(JX)
      IF(IPRI.EQ.0) THEN
       VXCA=VXCA+CONST(I)*(DRDA(JR)*X(JX)+R(JR)*DXDA(JX)- &
       (DRDA(JR)*GRO2A+DRDB(JR)*GFUGFD+R(JR)*(XLAPA- &
        CON43*GFGFU/RO-GDGGU/GROA))/F43MU)
       VXCB=VXCB+CONST(I)*(DRDB(JR)*X(JX)+R(JR)*DXDB(JX)- &
       (DRDB(JR)*GRO2B+DRDA(JR)*GFUGFD+R(JR)*(XLAPB- &
        CON43*GFGFD/RO-GDGGD/GROB))/F43MD)
      ELSE
        VXCA=VXCA+CONST(I)*(DRDA(JR)*X(JX)+R(JR)*DXDA(JX))
        VXCB=VXCB+CONST(I)*(DRDB(JR)*X(JX)+R(JR)*DXDB(JX))
      ENDIF
      ENDDO
 9    DO I=10,12
       JR=ICONR(I)
       JX=2
       EXC=EXC+CONST(I)*R(JR)*X(JX)
       VXCA=VXCA+CONST(I)*(DRDA(JR)*X(JX)+R(JR)*DXDA(JX)- &
            (DRDA(JR)*GRO2A+DRDB(JR)*GFUGFD+ &
            R(JR)*(XLAPA-CON83*GFGFU/RO))/RO**CON83)
       VXCB=VXCB+CONST(I)*(DRDB(JR)*X(JX)+R(JR)*DXDB(JX)- &
            (DRDB(JR)*GRO2B+DRDA(JR)*GFUGFD+ &
            R(JR)*(XLAPB-CON83*GFGFD/RO))/RO**CON83)
      ENDDO
      DO I=13,15
       JR=ICONR(I)
       EXC=EXC+CONST(I)*R(JR)*Y
       VXCA=VXCA+CONST(I)*(DRDA(JR)*Y+R(JR)*DYDA- &
       (2.D0*(DRDA(JR)*(GRO2A-GFUGFD)+DRDB(JR)*(GFUGFD-GRO2B))- &
        R(JR)*(XLAPA-XLAPB-CON83*(GFGFU-GFGFD)))/RO**CON83)
       VXCA=VXCA+CONST(I)*(DRDB(JR)*Y+R(JR)*DYDB- &
       (2.D0*(DRDB(JR)*(GRO2B-GFUGFD)+DRDA(JR)*(GFUGFD-GRO2A))- &
        R(JR)*(XLAPB-XLAPA-CON83*(GFGFD-GFGFU)))/RO**CON83)
      ENDDO
      DO I=16,19
       JR=ICONR(I)
       EXC=EXC+CONST(I)*R(JR)*S
       VXCA=VXCA+CONST(I)*(DRDA(JR)*S+R(JR)*DSDA)
       VXCB=VXCB+CONST(I)*(DRDB(JR)*S+R(JR)*DSDB)
      ENDDO
      EXC=EXC/RO
      RETURN
      END
